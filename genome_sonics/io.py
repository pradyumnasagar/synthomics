"""
IO Module - FASTA parsing and demo sequence management.
"""

import os
from pathlib import Path
from typing import List, Tuple, Optional
import re

# Valid DNA characters
VALID_DNA = set('ATGCNatgcn')

# Demo sequence directory
ASSETS_DIR = Path(__file__).parent / "assets" / "demo_sequences"


def parse_fasta(content: str) -> List[Tuple[str, str]]:
    """
    Parse FASTA format content.
    
    Args:
        content: FASTA file content as string
        
    Returns:
        List of (header, sequence) tuples
    """
    sequences = []
    current_header = None
    current_seq = []
    
    for line in content.strip().split('\n'):
        line = line.strip()
        if not line:
            continue
        if line.startswith('>'):
            # Save previous sequence
            if current_header is not None:
                sequences.append((current_header, ''.join(current_seq)))
            current_header = line[1:].strip()
            current_seq = []
        else:
            current_seq.append(line.upper())
    
    # Don't forget the last sequence
    if current_header is not None:
        sequences.append((current_header, ''.join(current_seq)))
    
    return sequences


def parse_fasta_file(filepath: str) -> List[Tuple[str, str]]:
    """Parse FASTA from file path."""
    with open(filepath, 'r') as f:
        return parse_fasta(f.read())


def validate_sequence(seq: str) -> Tuple[bool, str, str]:
    """
    Validate and clean a DNA sequence.
    
    Args:
        seq: Raw sequence string
        
    Returns:
        (is_valid, cleaned_sequence, error_message)
    """
    # Remove whitespace
    cleaned = re.sub(r'\s', '', seq.upper())
    
    # Check for invalid characters
    invalid_chars = set(cleaned) - VALID_DNA
    if invalid_chars:
        # Try to clean by removing invalid chars
        cleaned = ''.join(c for c in cleaned if c in VALID_DNA)
        if len(cleaned) == 0:
            return False, "", f"No valid DNA characters found"
        return True, cleaned, f"Removed invalid characters: {invalid_chars}"
    
    return True, cleaned, ""


def validate_dna_sequence(seq: str) -> str:
    """
    Strict validation for manual input.
    
    Args:
        seq: Raw input string
        
    Returns:
        Cleaned sequence string (ACGT only)
        
    Raises:
        ValueError: If contains invalid chars or is empty/too long
    """
    if not seq:
        raise ValueError("Sequence is empty.")
        
    # Remove whitespace/newlines/tabs
    cleaned = re.sub(r'\s+', '', seq.upper())
    
    if not cleaned:
        raise ValueError("Sequence is empty after cleaning.")
        
    # Check max length (Hard limit for manual input)
    if len(cleaned) > 50000:
        raise ValueError(f"Sequence too long ({len(cleaned):,} bp). Manual input limited to 50,000 bp.")
        
    # Check for invalid characters
    invalid_chars = set(cleaned) - set('ATGC')
    if invalid_chars:
        # Show first few invalid chars
        bad = list(invalid_chars)[:5]
        raise ValueError(f"Invalid DNA characters found: {', '.join(bad)}. Only A, T, G, C allowed.")
        
    return cleaned


def sample_sequence(seq: str, max_length: int = 50000, method: str = "smart") -> str:
    """
    Sample a long sequence to manageable length.
    
    Args:
        seq: Input sequence
        max_length: Maximum output length
        method: 'smart' (representative tiles), 'start', 'random'
        
    Returns:
        Sampled sequence
    """
    if len(seq) <= max_length:
        return seq
    
    if method == "start":
        return seq[:max_length]
    
    elif method == "random":
        import random
        start = random.randint(0, len(seq) - max_length)
        return seq[start:start + max_length]
    
    else:  # smart - take tiles from different regions
        tile_count = 10
        tile_size = max_length // tile_count
        step = len(seq) // tile_count
        
        tiles = []
        for i in range(tile_count):
            start = i * step
            tiles.append(seq[start:start + tile_size])
        
        return ''.join(tiles)


def get_demo_list() -> List[dict]:
    """
    Get list of available demo sequences.
    
    Returns:
        List of dicts with 'name', 'description', 'filename'
    """
    demos = [
        {
            "name": "HPV-16 E6/E7",
            "description": "Human papillomavirus oncogenes (~500 bp)",
            "filename": "hpv16_e6e7.fasta",
            "organism": "virus"
        },
        {
            "name": "SARS-CoV-2 Spike",
            "description": "COVID-19 spike protein gene (~3,800 bp)",
            "filename": "sarscov2_spike.fasta",
            "organism": "virus"
        },
        {
            "name": "E. coli 16S rRNA",
            "description": "Bacterial identification marker (~1,500 bp)",
            "filename": "ecoli_16s.fasta",
            "organism": "bacteria"
        },
        {
            "name": "BRCA1 Snippet",
            "description": "Human breast cancer gene fragment (~1,000 bp)",
            "filename": "brca1_snippet.fasta",
            "organism": "human"
        },
        {
            "name": "Random DNA",
            "description": "Computer-generated random sequence (500 bp)",
            "filename": "random_dna.fasta",
            "organism": "synthetic"
        },
        {
            "name": "HTT Normal (CAG20)",
            "description": "Huntington gene (HTT) normal allele, 20 CAG repeats",
            "filename": "htt_normal_cag20.fasta",
            "organism": "human"
        },
        {
            "name": "HTT Huntington-like (CAG45)",
            "description": "Huntington gene (HTT) expanded allele, 45 CAG repeats",
            "filename": "htt_hd_cag45.fasta",
            "organism": "human"
        },
        {
            "name": "DMPK Normal (CTG12)",
            "description": "Myotonic dystrophy gene (DMPK) normal allele, 12 CTG repeats",
            "filename": "dmpk_normal_ctg12.fasta",
            "organism": "human"
        },
        {
            "name": "DMPK DM1-like (CTG80)",
            "description": "Myotonic dystrophy gene (DMPK) expanded allele, 80 CTG repeats",
            "filename": "dmpk_dm1_ctg80.fasta",
            "organism": "human"
        },
        {
            "name": "FMR1 Normal (CGG30)",
            "description": "Fragile X gene (FMR1) normal allele, 30 CGG repeats",
            "filename": "fmr1_normal_cgg30.fasta",
            "organism": "human"
        },
        {
            "name": "FMR1 Expanded (CGG120)",
            "description": "Fragile X gene (FMR1) expanded allele, 120 CGG repeats",
            "filename": "fmr1_expanded_cgg120.fasta",
            "organism": "human"
        },
        {
            "name": "HBB Normal (HbA)",
            "description": "Hemoglobin beta (HBB) normal allele",
            "filename": "hbb_normal_hba.fasta",
            "organism": "human"
        },
        {
            "name": "HBB Sickle (HbS)",
            "description": "Hemoglobin beta (HBB) sickle trait point mutation",
            "filename": "hbb_sickle_hbs.fasta",
            "organism": "human"
        }
    ]
    return demos


def load_demo_sequence(name: str) -> Optional[Tuple[str, str]]:
    """
    Load a built-in demo sequence by name.
    
    Args:
        name: Demo sequence name (e.g., "HPV-16 E6/E7")
        
    Returns:
        (header, sequence) tuple or None if not found
    """
    demos = get_demo_list()
    demo = next((d for d in demos if d["name"] == name), None)
    
    if demo is None:
        return None
    
    filepath = ASSETS_DIR / demo["filename"]
    
    if not filepath.exists():
        # Return embedded sequence if file doesn't exist
        return _get_embedded_demo(name)
    
    sequences = parse_fasta_file(str(filepath))
    return sequences[0] if sequences else None


def _get_embedded_demo(name: str) -> Optional[Tuple[str, str]]:
    """Get embedded demo sequences (fallback if files don't exist)."""
    
    embedded = {
        "HPV-16 E6/E7": (
            "HPV16_E6E7_oncogenes",
            "ATGCACCAAAAGAGAACTGCAATGTTTCAGGACCCACAGGAGCGACCCAGAAAGTTACCACAGTTATGCACAGAGCTGCAAACAACTATACATGATATAATATTAGAATGTGTGTACTGCAAGCAACAGTTACTGCGACGTGAGGTATATGACTTTGCTTTTCGGGATTTATGCATAGTATATAGAGATGGGAATCCATATGCTGTATGTGATAAATGTTTAAAGTTTTATTCTAAAATTAGTGAGTATAGACATTATTGTTATAGTTTGTATGGAACAACATTAGAACAGCAATACAACAAACCGTTGTGTGATTTGTTAATTAGGTGTATTAACTGTCAAAAGCCACTGTGTCCTGAAGAAAAGCAAAGACATCTGGACAAAAAGCAAAGATTCCATAATATAAGGGGTCGGTGGACCGGTCGATGTATGTCTTGTTGCAGATCATCAAGAACACGTAGAGAAACCCAGCTGTAATCATGCATGGAGATACACCTACATTGCATGAATATATGTTAGATTTGCAACCAGAGACAACTGATCTCTACTGTTATGAGCAATTAAATGACAGCTCAGAGGAGGAGGATGAAATAGATGGTCCAGCTGGACAAGCAGAACCGGACAGAGCCCATTACAATATTGTAACCTTTTGTTGCAAGTGTGACTCTACGCTTCGGTTGTGCGTACAAAGCACACACGTAGACATTCGTACTTTGGAAGACCTGTTAATGGGCACACTAGGAATTGTGTGCCCCATCTGTTCTCAGAAACCATAATCTAC"
        ),
        "SARS-CoV-2 Spike": (
            "SARS-CoV-2_Spike_Gene",
            "ATGTTTGTTTTTCTTGTTTTATTGCCACTAGTCTCTAGTCAGTGTGTTAATCTTACAACCAGAACTCAATTACCCCCTGCATACACTAATTCTTTCACACGTGGTGTTTATTACCCTGACAAAGTTTTCAGATCCTCAGTTTTACATTCAACTCAGGACTTGTTCTTACCTTTCTTTTCCAATGTTACTTGGTTCCATGCTATACATGTCTCTGGGACCAATGGTACTAAGAGGTTTGATAACCCTGTCCTACCATTTAATGATGGTGTTTATTTTGCTTCCACTGAGAAGTCTAACATAATAAGAGGCTGGATTTTTGGTACTACTTTAGATTCGAAGACCCAGTCCCTACTTATTGTTAATAACGCTACTAATGTTGTTATTAAAGTCTGTGAATTTCAATTTTGTAATGATCCATTTTTGGGTGTTTATTACCACAAAAACAACAAAAGTTGGATGGAAAGTGAGTTCAGAGTTTATTCTAGTGCGAATAATTGCACTTTTGAATATGTCTCTCAGCCTTTTCTTATGGACCTTGAAGGAAAACAGGGTAATTTCAAAAATCTTAGGGAATTTGTGTTTAAGAATATTGATGGTTATTTTAAAATATATTCTAAGCACACGCCTATTAATTTAGTGCGTGATCTCCCTCAGGGTTTTTCGGCTTTAGAACCATTGGTAGATTTGCCAATAGGTATTAACATCACTAGGTTTCAAACTTTACTTGCTTTACATAGAAGTTATTTGACTCCTGGTGATTCTTCTTCAGGTTGGACAGCTGGTGCTGCAGCTTATTATGTGGGTTATCTTCAACCTAGGACTTTTCTATTAAAATATAATGAAAATGGAACCATTACAGATGCTGTAGACTGTGCACTTGACCCTCTCTCAGAAACAAAGTGTACGTTGAAATCCTTCACTGTAGAAAAAGGAATCTATCAAACTTCTAACTTTAGAGTCCAACCAACAGAATCTATTGTTAGATTTCCTAATATTACAAACTTGTGCCCTTTTGGTGAAGTTTTTAACGCCACCAGATTTGCATCTGTTTATGCTTGGAACAGGAAGAGAATCAGCAACTGTGTTGCTGATTATTCTGTCCTATATAATTCCGCATCATTTTCCACTTTTAAGTGTTATGGAGTGTCTCCTACTAAATTAAATGATCTCTGCTTTACTAATGTCTATGCAGATTCATTTGTAATTAGAGGTGATGAAGTCAGACAAATCGCTCCAGGGCAAACTGGAAAGATTGCTGATTATAATTATAAATTACCAGATGATTTTACAGGCTGCGTTATAGCTTGGAATTCTAACAATCTTGATTCTAAGGTTGGTGGTAATTATAATTACCTGTATAGATTGTTTAGGAAGTCTAATCTCAAACCTTTTGAGAGAGATATTTCAACTGAAATCTATCAGGCCGGTAGCACACCTTGTAATGGTGTTGAAGGTTTTAATTGTTACTTTCCTTTACAATCATATGGTTTCCAACCCACTAATGGTGTTGGTTACCAACCATACAGAGTAGTAGTACTTTCTTTTGAACTTCTACATGCACCAGCAACTGTTTGTGGACCTAAAAAGTCTACTAATTTGGTTAAAAACAAATGTGTCAATTTCAACTTCAATGGTTTAACAGGCACAGGTGTTCTTACTGAGTCTAACAAAAAGTTTCTGCCTTTCCAACAATTTGGCAGAGACATTGCTGACACTACTGATGCTGTCCGTGATCCACAGACACTTGAGATTCTTGACATTACACCATGTTCTTTTGGTGGTGTCAGTGTTATAACACCAGGAACAAATACTTCTAACCAGGTTGCTGTTCTTTATCAGGATGTTAACTGCACAGAAGTCCCTGTTGCTATTCATGCAGATCAACTTACTCCTACTTGGCGTGTTTATTCTACAGGTTCTAATGTTTTTCAAACACGTGCAGGCTGTTTAATAGGGGCTGAACATGTCAACAACTCATATGAGTGTGACATACCCATTGGTGCAGGTATATGCGCTAGTTATCAGACTCAGACTAATTCTCCTCGGCGGGCACGTAGTGTAGCTAGTCAATCCATCATTGCCTACACTATGTCACTTGGTGCAGAAAATTCAGTTGCTTACTCTAATAACTCTATTGCCATACCCACAAATTTTACTATTAGTGTTACCACAGAAATTCTACCAGTGTCTATGACCAAGACATCAGTAGATTGTACAATGTACATTTGTGGTGATTCAACTGAATGCAGCAATCTTTTGTTGCAATATGGCAGTTTTTGTACACAATTAAACCGTGCTTTAACTGGAATAGCTGTTGAACAAGACAAAAACACCCAAGAAGTTTTTGCACAAGTCAAACAAATTTACAAAACACCACCAATTAAAGATTTTGGTGGTTTTAATTTTTCACAAATATTACCAGATCCATCAAAACCAAGCAAGAGGTCATTTATTGAAGATCTACTTTTCAACAAAGTGACACTTGCAGATGCTGGCTTCATCAAACAATATGGTGATTGCCTTGGTGATATTGCTGCTAGAGACCTCATTTGTGCACAAAAGTTTAACGGCCTTACTGTTTTGCCACCTTTGCTCACAGATGAAATGATTGCTCAATACACTTCTGCACTGTTAGCGGGTACAATCACTTCTGGTTGGACCTTTGGTGCAGGTGCTGCATTACAAATACCATTTGCTATGCAAATGGCTTATAGGTTTAATGGTATTGGAGTTACACAGAATGTTCTCTATGAGAACCAAAAATTGATTGCCAACCAATTTAATAGTGCTATTGGCAAAATTCAAGACTCACTTTCTTCCACAGCAAGTGCACTTGGAAAACTTCAAGATGTGGTCAACCAAAATGCACAAGCTTTAAACACGCTTGTTAAACAACTTAGCTCCAATTTTGGTGCAATTTCAAGTGTTTTAAATGATATCCTTTCACGTCTTGACAAAGTTGAGGCTGAAGTGCAAATTGATAGGTTGATCACAGGCAGACTTCAAAGTTTGCAGACATATGTGACTCAACAATTAATTAGAGCTGCAGAAATCAGAGCTTCTGCTAATCTTGCTGCTACTAAAATGTCAGAGTGTGTACTTGGACAATCAAAAAGAGTTGATTTTTGTGGAAAGGGCTATCATCTTATGTCCTTCCCTCAGTCAGCACCTCATGGTGTAGTCTTCTTGCATGTGACTTATGTCCCTGCACAAGAAAAGAACTTCACAACTGCTCCTGCCATTTGTCATGATGGAAAAGCACACTTTCCTCGTGAAGGTGTCTTTGTTTCAAATGGCACACACTGGTTTGTAACACAAAGGAATTTTTATGAACCACAAATCATTACTACAGACAACACATTTGTGTCTGGTAACTGTGATGTTGTAATAGGAATTGTCAACAACACAGTTTATGATCCTTTGCAACCTGAATTAGACTCATTCAAGGAGGAGTTAGATAAATATTTTAAGAATCATACATCACCAGATGTTGATTTAGGTGACATCTCTGGCATTAATGCTTCAGTTGTAAACATTCAAAAAGAAATTGACCGCCTCAATGAGGTTGCCAAGAATTTAAATGAATCTCTCATCGATCTCCAAGAACTTGGAAAGTATGAGCAGTATATAAAATGGCCATGGTACATTTGGCTAGGTTTTATAGCTGGCTTGATTGCCATAGTAATGGTGACAATTATGCTTTGCTGTATGACCAGTTGCTGTAGTTGTCTCAAGGGCTGTTGTTCTTGTGGATCCTGCTGCAAATTTGATGAAGACGACTCTGAGCCAGTGCTCAAAGGAGTCAAATTACATTACACATAA"
        ),
        "E. coli 16S rRNA": (
            "Ecoli_16S_rRNA",
            "AAATTGAAGAGTTTGATCATGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAACAGGAAGCAGCTTGCTGCTTTGCTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGCACAAAGAGGGGGACCTTAGGGCCTCTTGCCATCGGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGGAGTAAAGTTAATACCTTTGCTCATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGCAGCCGCGGTAATACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTTTGTTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCTGATACTGGCAAGCTTGAGTCTCGTAGAGGGGGGTAGAATTCCAGGTGTAGCGGTGAAATGCGTAGAGATCTGGAGGAATACCGGTGGCGAAGGCGGCCCCCTGGACGAAGACTGACACGAGGTGCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCGACTTGGAGGTTGTGCCCTTGAGGCGTGGCTTCCGGAGCTAACGCGTTAAGTCGACCGCCTGGGGAGTACGGCCGCAAGGTTAAAACTCAAATGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGATGCAACGCGAAGAACCTTACCTGGTCTTGACATCCACGGAAGTTTTCAGAGATGAGAATGTGCCTTCGGGAACCGTGAGACAGGTGCTGCATGGCTGTCGTCAGCTCGTGTTGTGAAATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTATCCTTTGTTGCCAGCGGTCCGGCCGGGAACTCAAAGGAGACTGCCAGTGATAAACTGGAGGAAGGTGGGGATGACGTCAAGTCATCATGGCCCTTACGACCAGGGCTACACACGTGCTACAATGGCGCATACAAAGAGAAGCGACCTCGCGAGAGCAAGCGGACCTCATAAAGTGCGTCGTAGTCCGGATTGGAGTCTGCAACTCGACTCCATGAAGTCGGAATCGCTAGTAATCGTGGATCAGAATGCCACGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCATGGGAGTGGGTTGCAAAAGAAGTAGGTAGCTTAACCTTCGGGAGGGCGCTTACCACTTTGTGATTCATGACTGGGGTGAAGTCGTAACAAGGTAACCGTAGGGGAACCTGCGGTTGGATCACCTCCTTA"
        ),
        "BRCA1 Snippet": (
            "BRCA1_Exon11_Snippet",
            "ATGGATTTATCTGCTCTTCGCGTTGAAGAAGTACAAAATGTCATTAATGCTATGCAGAAAATCTTAGAGTGTCCCATCTGTCTGGAGTTGATCAAGGAACCTGTCTCCACAAAGTGTGACCACATATTTTGCAAATTTTGCATGCTGAAACTTCTCAACCAGAAGAAAGGGCCTTCACAGTGTCCTTTATGTAAGAATGATATAACCAAAAGGAGCCTACAAGAAAGTACGAGATTTAGTCAACTTGTTGAAGAGCTATTGAAAATCATTTGTGCTTTTCAGCTTGACACAGGTTTGGAGTATGCAAACAGCTATAATTTTGCAAAAAAGGAAAATAACTCTCCTGAACATCTAAAAGATGAAGTTTCTATCATCCAAAGTATGGGCTACAGAAACCGTGCCAAAAGACTTCTACAGAGTGAACCCGAAAATCCTTCCTTGCAGGAAACCAGTCTCAGTGTCCAACTCTCTAACCTTGGAACTGTGAGAACTCTGAGGACAAAGCAGCGGATACAACCTCAAAAGACGTCTGTCTACATTGAATTGGGATCTGATTCTTCTGAAGATACCGTTAATAAGGCAACTTATTGCAGTGTGGGAGATCAAGAATTGTTACAAATCACCCCTCAAGGAACCAGGGATGAAATCAGTTTGGATTCTGCAAAAAAGGCTGCTTGTGAATTTTCTGAGACGGATGTAACAAATACTGAACATCATCAACCCAGTAATAATGATTTGAACACCACTGAGAAGCGTGCAGCTGAGAGGCATCCAGAAAAGTATCAGGGTAGTTCTGTTTCAAACTTGCATGTGGAGCCATGTGGCACAAATACTCATGCCAGCTCATTACAGCATGAGAACAGCAGTTTATTACTCACTAAAGACAGAATGAATGTAGAAAAGGCTGAATTCTGTAATAAAAGCAAACAGCCTGGCTTAGCAAGGAGCCAACATAACAGATGGGCTGGAAGTAAGGAAACATGTAATGATAGGCGGACTCCCAGCACAGAAAAAAAGGTAGATCTGAATGCTGATCCCCTGTGTGAGAGAAAAGAATGGAATAAGCAGAAACTGCCATGCTCAGAGAATCCTAGAGATACTGAAGATGTTCCTTGGATAACACTAAATAG"
        ),
        "Random DNA": (
            "Random_Synthetic_DNA",
            "ATGCTAGCTAGCTAGCTAGCATGCATGCATGCATGCATGCAGTCAGTCAGTCAGTCAGTCATATATATATATATATATGCGCGCGCGCGCGCGCTAGCTAGCTAGCTAGCTAGCATATATGCGCATATATGCGCAGTCATGCAGTCATGCAGTCATGCATGCTAGCATGCTAGCATGCTAGCAGTCTAGCAGTCTAGCAGTCTAGCATATGATGCGTGATGCGTGATGCGTGATGCGTATGCATGCATGCATGCATAGCTAGCATGCTAGCAGTCAGTCATATGCGCATATGCGCATAGCTAGCAGATAGATCAGATCAGATCAGATCGATGCATGCATGCATGCAGTCAGTCAGTCAGTCTAGCTAGCTAGCTAGCATAGCTAGCATGCATGCATGCATGC"
        ),
        "HTT Normal (CAG20)": (
            "HTT_exon1_normal_CAG20_demo",
            "ATGACGACGACGACGACGACAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAACAGCCGCCGCCGTTT"
        ),
        "HTT Huntington-like (CAG45)": (
            "HTT_exon1_HD_CAG45_demo",
            "ATGACGACGACGACGACGACAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAACAGCCGCCGCCGTTT"
        ),
        "DMPK Normal (CTG12)": (
            "DMPK_3UTR_normal_CTG12_demo",
            "GCTGAGGAGGAACTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGAATAAAGGCTT"
        ),
        "DMPK DM1-like (CTG80)": (
            "DMPK_3UTR_DM1_CTG80_demo",
            "GCTGAGGAGGAACTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGCTGAATAAAGGCTT"
        ),
        "FMR1 Normal (CGG30)": (
            "FMR1_5UTR_normal_CGG30_demo",
            "TTGAGTCCGGACGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCAGGCTCTCTC"
        ),
        "FMR1 Expanded (CGG120)": (
            "FMR1_5UTR_expanded_CGG120_demo",
            "TTGAGTCCGGACGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCAGGCTCTCTC"
        ),
        "HBB Normal (HbA)": (
            "HBB_Normal_HbA",
            "ATGGTGCATCTGACTCCTGAGGAGAAGTCTGCCGTTACTGCCCTGTGGGGCAAGGT"
        ),
        "HBB Sickle (HbS)": (
            "HBB_Sickle_HbS",
            "ATGGTGCATCTGACTCCTGTGGAGAAGTCTGCCGTTACTGCCCTGTGGGGCAAGGT"
        )
    }
    
    return embedded.get(name)


def get_sequence_info(header: str, seq: str) -> dict:
    """Get basic info about a sequence for display."""
    return {
        "header": header,
        "length": len(seq),
        "preview": seq[:50] + "..." if len(seq) > 50 else seq
    }
